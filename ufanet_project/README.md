# Ufanet Django Promo

API для управления акциями и скидками партнеров Уфанет.

## Требования

- Python 3.9+
- Django 5.2+
- Django REST Framework
- PostgreSQL

## Установка

1. Клонируйте репозиторий
2. Создайте виртуальное окружение:
   ```bash
   python -m venv venv
   source venv/bin/activate  # для Linux/Mac
   # или
   venv\Scripts\activate  # для Windows
   ```
3. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
4. Скопируйте `.env.example` в `.env` и заполните необходимые переменные окружения
5. Примените миграции:
   ```bash
   python manage.py migrate
   ```
6. Запустите сервер:
   ```bash
   python manage.py runserver
   ```

Для загрузки тестовых данных выполните:

```bash
python manage.py loaddata initial_data
```

## Функционал приложения

### Веб-интерфейс

#### Главная страница
- Отображение списка всех категорий акций
- Каждая категория представлена карточкой с названием и описанием
- При клике на категорию происходит переход к списку акций в данной категории

#### Страница категории
- Отображение всех акций в выбранной категории
- Фильтрация акций по городу через выпадающий список


#### Страница акции
- Детальная информация об акции:
  - Название и описание
  - Размер скидки
  - Промокод (если есть)
  - Срок действия
  - Информация о партнере
  - Город проведения
  - Категория
- Отображение логотипа партнера

#### Поиск
- Поисковая строка на всех страницах
- Поиск по:
  - Названию акции
  - Описанию акции
  - Названию партнера
- Фильтрация результатов поиска по городу
- Отображение количества найденных результатов

#### Список всех акций
- Полный список всех акций
- Пагинация результатов


### REST API

#### Управление городами
- Получение списка всех городов
- Получение информации о конкретном городе
- Получение списка акций в конкретном городе
- Поиск городов по названию

#### Управление категориями
- Получение списка всех категорий
- Получение информации о конкретной категории
- Получение списка акций в конкретной категории
- Поиск категорий по названию

#### Управление партнерами
- Получение списка всех партнеров
- Получение информации о конкретном партнере
- Получение списка активных акций партнера
- Поиск партнеров по названию и описанию

#### Управление акциями
- Получение списка всех акций
- Получение информации о конкретной акции
- Создание новой акции
- Обновление существующей акции
- Удаление акции
- Получение списка активных акций
- Получение списка акций, срок действия которых истекает в течение недели

#### Фильтрация и поиск
- Фильтрация акций по:
  - Городу
  - Категории
  - Партнеру
  - Диапазону скидок
  - Статусу активности
- Поиск по:
  - Названию акции
  - Описанию
  - Промокоду
- Сортировка по:
  - Дате начала
  - Дате окончания
  - Размеру скидки



### Дополнительные возможности

#### Административная панель
- Управление всеми моделями через Django Admin
- Создание, редактирование и удаление:
  - Городов
  - Категорий
  - Партнеров
  - Акций
- Загрузка и управление изображениями




## API Endpoints

### Города (Cities)

- `GET /api/cities/` - список всех городов
- `GET /api/cities/{id}/` - детали города
- `GET /api/cities/{id}/offers/` - акции в городе

### Категории (Categories)

- `GET /api/categories/` - список всех категорий
- `GET /api/categories/{id}/` - детали категории
- `GET /api/categories/{id}/offers/` - акции в категории

### Партнеры (Partners)

- `GET /api/partners/` - список всех партнеров
- `GET /api/partners/{id}/` - детали партнера
- `GET /api/partners/{id}/active_offers/` - активные акции партнера

### Акции (Offers)

- `GET /api/offers/` - список всех акций
- `GET /api/offers/{id}/` - детали акции
- `POST /api/offers/` - создание новой акции
- `PUT /api/offers/{id}/` - обновление акции
- `PATCH /api/offers/{id}/` - частичное обновление акции
- `DELETE /api/offers/{id}/` - удаление акции

##### Пример жсона для post запроса
-    "title": "Скидка 20% на первый месяц",
-    "description": "Специальное предложение для новых клиентов",
-    "promo_code": "NEW20",
-    "discount": 20,
-    "valid_from": "2024-03-20",
-    "valid_to": "2024-04-20",
-    "city_id": 1,
-    "category_id": 2,
-    "partner_id": 3




#### Специальные эндпоинты для акций

- `GET /api/offers/active/` - список активных акций
- `GET /api/offers/expiring_soon/` - список акций, срок действия которых истекает в течение недели

#### Фильтрация акций

Доступны следующие параметры фильтрации:
- `?city={id}` - фильтр по городу
- `?category={id}` - фильтр по категории
- `?partner={id}` - фильтр по партнеру
- `?min_discount={value}` - минимальная скидка
- `?max_discount={value}` - максимальная скидка
- `?active={true/false}` - фильтр по активности


#### Сортировка

- `?ordering={field}` - сортировка по полю
  - Доступные поля: valid_from, valid_to, discount
  - Для обратной сортировки используйте префикс "-"

## Веб-интерфейс

- `/` - главная страница со списком категорий
- `/categories/` - список всех категорий
- `/category/{id}/` - список акций в категории
- `/offer/{id}/` - детальная страница акции
- `/search/` - поиск акций
- `/offers/` - список всех акций


### Запуск тестов

```bash
python manage.py test
```



